<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<!-- Configuration pour ASP.NET Core / .NET 8 -->
	<location path="." inheritInChildApplications="false">
		<system.webServer>
			<handlers>
				<add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />
			</handlers>
			<aspNetCore processPath="dotnet" arguments=".\InsecureAppWebNet8.dll" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" hostingModel="inprocess">
				<environmentVariables>
					<!-- VULNÉRABLE: Variables d'environnement avec secrets -->
					<environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Production" />
					<environmentVariable name="ConnectionStrings__DefaultConnection" value="Server=prod-db.example.com;Database=ProductionDB;User Id=sa;Password=P@ssw0rd123!;" />
					<environmentVariable name="JWT_SECRET" value="ThisIsMySecretKeyForJWT_MinimumLength32Characters" />
					<environmentVariable name="API_KEY" value="sk_live_4eC39HqLyjWDarjtT1zdp7dc" />
					<environmentVariable name="ADMIN_PASSWORD" value="SuperAdm!n2024" />

					<!-- VULNÉRABLE: Secrets AWS -->
					<environmentVariable name="AWS_ACCESS_KEY_ID" value="AKIAIOSFODNN7EXAMPLE" />
					<environmentVariable name="AWS_SECRET_ACCESS_KEY" value="wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY" />

					<!-- VULNÉRABLE: Secrets de services -->
					<environmentVariable name="STRIPE_SECRET_KEY" value="sk_live_51H0vKmICTx8fBbMHkV5xOvxk8Rku3Zvg5P" />
					<environmentVariable name="SENDGRID_API_KEY" value="SG.xxxxxxxxxxxxxxxxxxxx.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />
					<environmentVariable name="GITHUB_TOKEN" value="ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />

					<!-- VULNÉRABLE: OAuth secrets -->
					<environmentVariable name="GOOGLE_CLIENT_SECRET" value="GOCSPX-xxxxxxxxxxxxxxxxxxxxxxxxxx" />
					<environmentVariable name="FACEBOOK_APP_SECRET" value="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />

					<!-- VULNÉRABLE: Configuration SMTP -->
					<environmentVariable name="SMTP_PASSWORD" value="smtp-password-123" />
					<environmentVariable name="SMTP_USERNAME" value="noreply@example.com" />
				</environmentVariables>
			</aspNetCore>

			<!-- VULNÉRABLE: Headers de sécurité manquants ou mal configurés -->
			<httpProtocol>
				<customHeaders>
					<!-- Manque: X-Frame-Options, X-Content-Type-Options, CSP, etc. -->
					<remove name="X-Powered-By" />
				</customHeaders>
			</httpProtocol>

			<!-- VULNÉRABLE: Directory browsing activé -->
			<directoryBrowse enabled="true" />

			<!-- VULNÉRABLE: Detailed errors exposés -->
			<httpErrors errorMode="Detailed" />

			<!-- VULNÉRABLE: Tracing activé -->
			<tracing enabled="true" />
		</system.webServer>
	</location>

	<!-- VULNÉRABLE: Configuration de logging avec données sensibles -->
	<system.diagnostics>
		<trace autoflush="true">
			<listeners>
				<add name="textWriterTraceListener" type="System.Diagnostics.TextWriterTraceListener" initializeData="C:\logs\trace.log" />
			</listeners>
		</trace>
	</system.diagnostics>

	<!-- VULNÉRABLE: Connection strings (compatibilité avec ancien code) -->
	<connectionStrings>
		<add name="DefaultConnection"
			 connectionString="Data Source=prod-sql.example.com;Initial Catalog=ProductionDB;User ID=sa;Password=SQLServerP@ssw0rd123!;MultipleActiveResultSets=True"
			 providerName="System.Data.SqlClient" />

		<add name="AuditConnection"
			 connectionString="Server=audit-db.example.com;Database=AuditDB;Uid=audit_user;Pwd=AuditP@ss2024;"
			 providerName="MySql.Data.MySqlClient" />

		<add name="CacheConnection"
			 connectionString="redis-cluster.example.com:6379,password=RedisP@ss123,ssl=False,abortConnect=False" />
	</connectionStrings>

	<!-- VULNÉRABLE: AppSettings avec secrets -->
	<appSettings>
		<!-- Secrets API -->
		<add key="ApiKey" value="4f8b5c3d-9e2a-4b6f-8d1c-3a7e9f2b5d8c" />
		<add key="MasterKey" value="MASTER_KEY_PRODUCTION_2024" />
		<add key="EncryptionPassword" value="Encrypt!0nP@ssw0rd" />

		<!-- VULNÉRABLE: Tokens et secrets -->
		<add key="JwtSecretKey" value="jwt_secret_key_minimum_256_bits_long_for_security" />
		<add key="BearerToken" value="Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." />

		<!-- VULNÉRABLE: Credentials administrateur -->
		<add key="AdminUsername" value="superadmin" />
		<add key="AdminPassword" value="SuperAdm!n2024" />
		<add key="AdminEmail" value="admin@example.com" />

		<!-- VULNÉRABLE: Clés de chiffrement faibles -->
		<add key="AES_KEY" value="1234567890123456789012345678901234567890123456789012345678901234" />
		<add key="AES_IV" value="1234567890123456" />

		<!-- VULNÉRABLE: Secrets de base de données -->
		<add key="DB_BACKUP_PASSWORD" value="BackupP@ss2024" />
		<add key="DB_MASTER_KEY" value="DbMasterKey123!@#" />
	</appSettings>

	<!-- VULNÉRABLE: Configuration pour IIS avec authentification faible -->
	<system.web>
		<!-- VULNÉRABLE: Machine Key hardcodée (pour compatibilité) -->
		<machineKey validationKey="1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF"
					decryptionKey="ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890ABCDEF1234567890"
					validation="HMACSHA256" />

		<!-- VULNÉRABLE: Session state avec connection string -->
		<sessionState mode="SQLServer"
					  sqlConnectionString="server=session-db.example.com;uid=session_user;pwd=SessionP@ss123"
					  cookieless="false"
					  regenerateExpiredSessionId="true"
					  timeout="20" />
	</system.web>

	<!-- VULNÉRABLE: WCF endpoints avec credentials (si utilisé) -->
	<system.serviceModel>
		<bindings>
			<basicHttpBinding>
				<binding name="BasicHttpBinding_IService">
					<security mode="TransportCredentialOnly">
						<transport clientCredentialType="Basic" />
					</security>
				</binding>
			</basicHttpBinding>
		</bindings>
		<behaviors>
			<endpointBehaviors>
				<behavior name="ServiceBehavior">
					<clientCredentials>
						<windows>
							<clientCredential userName="service_user" password="ServiceP@ssw0rd123!" domain="EXAMPLE" />
						</windows>
					</clientCredentials>
				</behavior>
			</endpointBehaviors>
		</behaviors>
	</system.serviceModel>
</configuration>